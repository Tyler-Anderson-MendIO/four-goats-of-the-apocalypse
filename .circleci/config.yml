# This config was automatically generated from your source code
# Stacks detected: cicd:github-actions:.github/workflows,deps:java:.,deps:node:.,deps:python:.
version: 2.1
orbs:
  node: circleci/node@5
  python: circleci/python@2
jobs:
  mend_cli_run:
    docker:
      - image: cimg/base:stable
        user: root
    environment:
      MEND_EMAIL: $MEND_EMAIL # Your email address; can be inserted as a CircleCI Project settings environment variable.
      MEND_USER_KEY: $USER_KEY # Your Mend user key; can be inserted as a CircleCI Project settings environment variable.
      # MEND_ORGANIZATION: $ORG_KEY
      MEND_URL: "https://app.whitesourcesoftware.com" # Make sure to change this to your Mend or WS instance.
    steps:
      - run:
          name: Print Environment Variables
          command: |
            echo "MEND_EMAIL=$API_KEY"
            echo "MEND_USER_KEY=$USER_KEY"
            echo "MEND_URL=$MEND_URL"
      - run:
          name: Download Mend CLI
          command: curl https://downloads.mend.io/cli/linux_amd64/mend -o /usr/local/bin/mend && chmod +x /usr/local/bin/mend
      - run:
          name: mend auth info check
          command: mend auth info
      - run:
          name: Run Mend CLI SCA Scan
          command: mend dep -u -s "CircleCITest//test1"


  deploy:
    # This is an example deploy job, not actually used by the workflow
    docker:
      - image: cimg/base:stable
    steps:
      # Replace this with steps to deploy to users
      - run:
          name: deploy
          command: '#e.g. ./deploy.sh'
      - run:
          name: found github actions config
          command: ':'
workflows:
  build-and-test:
    jobs:
      - mend_cli_run
